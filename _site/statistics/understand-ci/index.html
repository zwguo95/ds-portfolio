<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Zhaowen Guo">
<meta name="dcterms.date" content="2025-08-27">
<title>Zhaowen Guo - Overlap but Significant: Understanding and Communicating Treatment Effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../headshot_guo.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-J1PPVYDT7J"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-J1PPVYDT7J', { 'anonymize_ip': true});
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Zhaowen Guo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../statistics.html" rel="" target="">
 <span class="menu-text">Statistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../dataviz.html" rel="" target="">
 <span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">
<li>
    <a class="dropdown-item" href="../../tutorials/word_embeddings.html" rel="" target="">
 <span class="dropdown-text">Word Embeddings with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/survey_data_visualization.html" rel="" target="">
 <span class="dropdown-text">Visualizing Survey Data with R</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/zhaowen-guo-20535312a/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/zwguo95" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:zg234@georgetown.edu" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resume" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-file-earmark-person" role="img">
</i> 
 <span class="menu-text">Resume</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-resume">
<li>
    <a class="dropdown-item" href="../../resume/resume_guo.pdf" rel="" target="">
 <span class="dropdown-text">Resume</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resume/cv_guo.pdf" rel="" target="">
 <span class="dropdown-text">CV</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Overlap but Significant: Understanding and Communicating Treatment Effects</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">statistics</div>
                <div class="quarto-category">experimental design</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.linkedin.com/in/zhaowen-guo-20535312a/">Zhaowen Guo</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 27, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="the-paradox" class="level1"><h1>The paradox</h1>
<p>At a recent talk, I presented RCT results using the graph below, showing weighted and unweighted group means with 95% confidence intervals (CIs) for control and treatment. An audience raised an interesting question, “If the error bars overlap, how can the treatment be significant?”</p>
<p><img src="overlapped-ci.png" class="img-fluid"></p>
<p>It can indeed feel paradoxical at the moment because the picture invites a common heuristic: <em>non-overlapping 95% CIs ⇒ statistically significant</em>. Many people then assume the converse where <em>overlapping 95% CIs ⇒ not significant</em>. But does the converse really hold? When we see overlap, does it naturally rule out a real treatment effect?</p>
</section><section id="why-overlap-neq-no-effect" class="level1"><h1>Why overlap <span class="math inline">\(\neq\)</span> no effect</h1>
<p>To probe this intuition, I first simulated two-arm experiments under a modest true effect. For each trial, I drew treatment and control samples, computed 95% CIs for each group mean, and then tested the difference in means. I then tracked two outcomes: (1) cases where the group CIs overlapped and the treatment effect was significant, and (2) cases where, given overlap, the effect was still significant—a direct check on the “<em>overlap ⇒ not significant”</em> intuition.</p>
<p>In 5,000 simulated trials (n=40 per arm, true effect <span class="math inline">\(\delta\)</span> = 0.1), I found that the two 95% CIs overlapped and the effect was significant in 22% of runs; among the overlapped cases, 25% still yielded a significant effect. Overlap, in other words, does not guarantee “no effect”.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">signed_norm_overlap</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ci1</span>, <span class="va">ci2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">avgw</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ci1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ci2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ci1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ci2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ci1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">avgw</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_once</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">40</span>, <span class="va">delta</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">welch</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="va">sd</span><span class="op">)</span></span>
<span>  <span class="va">yt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mC</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yc</span><span class="op">)</span>;  <span class="va">mT</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yt</span><span class="op">)</span></span>
<span>  <span class="va">seC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">yc</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>; <span class="va">seT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">yt</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">tcrit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">ciC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mC</span> <span class="op">-</span> <span class="va">tcrit</span><span class="op">*</span><span class="va">seC</span>, <span class="va">mC</span> <span class="op">+</span> <span class="va">tcrit</span><span class="op">*</span><span class="va">seC</span><span class="op">)</span></span>
<span>  <span class="va">ciT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mT</span> <span class="op">-</span> <span class="va">tcrit</span><span class="op">*</span><span class="va">seT</span>, <span class="va">mT</span> <span class="op">+</span> <span class="va">tcrit</span><span class="op">*</span><span class="va">seT</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">overlap</span> <span class="op">&lt;-</span> <span class="fu">signed_norm_overlap</span><span class="op">(</span><span class="va">ciC</span>, <span class="va">ciT</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">yt</span>, <span class="va">yc</span>, var.equal <span class="op">=</span> <span class="op">!</span><span class="va">welch</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>overlap <span class="op">=</span> <span class="va">overlap</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">summarize_rates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">B</span> <span class="op">=</span> <span class="fl">3000</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">40</span>, <span class="va">delta</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">welch</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span></span>
<span>    <span class="va">rbind</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu">sim_once</span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, <span class="va">sd</span>, <span class="va">alpha</span>, <span class="va">welch</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">overlap_flag</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">overlap</span> <span class="op">&gt;</span> <span class="fl">0</span>        </span>
<span>  <span class="va">sig_flag</span>     <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span>        </span>
<span></span>
<span>  <span class="co"># 1) P(overlap &amp; significant)</span></span>
<span>  <span class="va">k1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">overlap_flag</span> <span class="op">&amp;</span> <span class="va">sig_flag</span><span class="op">)</span>; <span class="va">N1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">ci1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">N1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">)</span></span>
<span>  <span class="va">rate_uncond</span> <span class="op">&lt;-</span> <span class="va">k1</span> <span class="op">/</span> <span class="va">N1</span></span>
<span></span>
<span>  <span class="co"># 2) P(significant | overlap)</span></span>
<span>  <span class="va">N2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">overlap_flag</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">N2</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">k2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sig_flag</span><span class="op">[</span><span class="va">overlap_flag</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">rate_cond</span> <span class="op">&lt;-</span> <span class="va">k2</span> <span class="op">/</span> <span class="va">N2</span></span>
<span>    <span class="va">ci2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">k2</span>, <span class="va">N2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">rate_cond</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span>; <span class="va">ci2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">NA_real_</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">sd</span>,</span>
<span>    snr <span class="op">=</span> <span class="va">delta</span> <span class="op">/</span> <span class="va">sd</span>,</span>
<span>    B <span class="op">=</span> <span class="va">B</span>,</span>
<span>    rate_overlap_sig_uncond <span class="op">=</span> <span class="va">rate_uncond</span>,</span>
<span>    ci_uncond_lo <span class="op">=</span> <span class="va">ci1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ci_uncond_hi <span class="op">=</span> <span class="va">ci1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    rate_sig_given_overlap  <span class="op">=</span> <span class="va">rate_cond</span>,</span>
<span>    ci_cond_lo <span class="op">=</span> <span class="va">ci2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ci_cond_hi <span class="op">=</span> <span class="va">ci2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    prop_overlap <span class="op">=</span> <span class="va">N2</span> <span class="op">/</span> <span class="va">N1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">summarize_rates</span><span class="op">(</span>B <span class="op">=</span> <span class="fl">5000</span>, n <span class="op">=</span> <span class="fl">40</span>, delta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Analytically, this actually makes sense. Per-group CIs capture the uncertainty around each mean, but the hypothesis test targets the uncertainty of their <strong><em>difference</em></strong>. For two independent groups with equal standard errors (SE), the standard error of the difference is</p>
<p><span class="math display">\[
SE_\Delta = \sqrt{SE^2_T + SE^2_C} = \sqrt{2} SE
\]</span></p>
<p>For a two-sided test at 5% significance level, we reject the null hypothesis when the estimated difference satisfies</p>
<p><span class="math display">\[
|\hat \Delta| &gt; 1.96 \times \sqrt{2} SE \approx 2.77 SE
\]</span></p>
<p>whereas non-overlapping 95% CIs would require</p>
<p><span class="math display">\[
|\hat \Delta| &gt; 2 \times 1.96SE = 3.92 SE &gt; 2.77 SE
\]</span></p>
<p>So there still exists a band in between—large enough to reject the null, but not large enough to prevent interval overlap. That’s the window where both statements are true: the group CIs overlap, yet the treatment effect is significant.</p>
</section><section id="when-it-can-happen" class="level1"><h1>When it can happen</h1>
<p>This naturally raises the next question: under what conditions are we more—or less—likely to observe overlapping 95% CIs still mean a real effect? We can first think about this analytically.</p>
<p>Let the 95% CI half-widths for the two group means be</p>
<p><span class="math display">\[
h_T = 1.96 \times SE_T \\
h_C = 1.96 \times SE_C \\
d = |\hat \Delta| = |\hat \mu_T - \hat \mu_C|
\]</span></p>
<p>We observe a significant difference (two-sided test at 5% significance level) when</p>
<p><span class="math display">\[ d &gt; 1.96 \times SE_\Delta, \space SE_\Delta = \sqrt{SE_T^2 + SE_C^2} \]</span></p>
<p>and non-overlapping 95% CIs when</p>
<p><span class="math display">\[ d &gt; h_T + h_C = 1.96 \times (SE_T + SE_C) \]</span></p>
<p>Then “significant while overlapping” happens when</p>
<p><span class="math display">\[
1.96 \times SE_\Delta &lt; d &lt; 1.96 \times (SE_T + SE_C)
\]</span></p>
<p>Standardizing by <span class="math inline">\(SE_\Delta\)</span>, this is equivalent to</p>
<p><span class="math display">\[
1.96 &lt; Z &lt; \frac{1.96}{r}, \space r = \frac{SE_\Delta}{SE_T + SE_C}
\]</span></p>
<p>Here, <span class="math inline">\(Z = \frac{d}{SE_\Delta}\)</span> is the standardized effect estimate, which (under large n) follows approximately standard normal with mean</p>
<p><span class="math display">\[
\theta = \frac{\delta}{SE_\Delta}
\]</span></p>
<p>where <span class="math inline">\(\delta\)</span> is the true difference is group means.</p>
<p>So the paradox window [1.96, 1.96/r] depends on</p>
<ul>
<li><p>Geometry parameter <span class="math inline">\(r = SE_\Delta / (SE_T + SE_C)\)</span>, which reflects study design (e.g.&nbsp;balance, variance structure, etc.</p></li>
<li><p>Signal parameter <span class="math inline">\(\theta\)</span> = <span class="math inline">\(\delta / SE_\Delta\)</span>, which reflects effect size relative to precision</p></li>
</ul>
<p>Every scenario I explore below can be understood as changing one of these parameters. These shifts determine how often the “significant while overlapping” phenomenon shows up in practice.</p>
<section id="a-sample-size-and-effect-size-signal-parameter-theta" class="level2"><h2 class="anchored" data-anchor-id="a-sample-size-and-effect-size-signal-parameter-theta">
<strong>(a) Sample size and effect size (signal parameter</strong> <span class="math inline">\(\theta\)</span><strong>)</strong>
</h2>
<p>Let’s start with sample size and effect size. For two groups of sizes <span class="math inline">\(n_T\)</span> and <span class="math inline">\(n_C\)</span> with common variance <span class="math inline">\(\sigma^2\)</span>,</p>
<p><span class="math display">\[
SE_\Delta = \sigma \sqrt{\frac{1}{n_T} + \frac{1}{n_C}}
\]</span></p>
<p>So we can rewrite</p>
<p><span class="math display">\[
\theta = \frac{\delta}{\sigma} \cdot \frac{1}{\sqrt{\frac{1}{n_T} + \frac{1}{n_C}}}
\]</span></p>
<p>This breaks into two parts:</p>
<ul>
<li><p><span class="math inline">\(\frac{\delta}{\sigma}\)</span> is the signal-to-noise ratio (SNR), meaning how large the effect is relative to individual-level variation</p></li>
<li><p><span class="math inline">\(1/\sqrt{1/n_T + 1/n_C}\)</span> is the effective sample size term</p></li>
</ul>
<p>For equal groups with size n, this simplifies to</p>
<p><span class="math display">\[
\theta = \frac{\delta}{\sigma}\sqrt{\frac{n}{2}}
\]</span></p>
<ul>
<li><p>If <span class="math inline">\(\theta\)</span> is too small, most samples fall below 1.96, and we won’t observe statistical significance.</p></li>
<li><p>If <span class="math inline">\(\theta\)</span> is too large, most samples exceed the overlap cutoff 1.96/r, and the CIs won’t overlap.</p></li>
<li><p>Only at intermediate <span class="math inline">\(\theta\)</span> (i.e.&nbsp;modest effect size and moderate n) do we often land in the narrow window [1.96, 1.96/r].</p></li>
</ul>
<p>To illustrate, I simulated two groups under different combinations of per-group sample size n and standardized effect size (<span class="math inline">\(\frac{\delta}{\sigma}\)</span>). For each setting, I recorded whether the group CIs overlapped and the two-sample test was still significant.</p>
<p>The results show that, for any given sample size, the probability of seeing this paradox peaks at moderate effect sizes. Also, with larger sample sizes, smaller effects become enough to land in the paradox window.</p>
<p><img src="sample_effect.png" class="img-fluid"></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">delta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.0</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">param_grid</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_grid</span>, delta <span class="op">=</span> <span class="va">delta_grid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">pmap_dfr</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">param_grid</span><span class="op">$</span><span class="va">n</span>, <span class="va">param_grid</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span>,</span>
<span>  <span class="op">~</span> <span class="fu">summarize_rates</span><span class="op">(</span>B <span class="op">=</span> <span class="va">B</span>, n <span class="op">=</span> <span class="va">..1</span>, delta <span class="op">=</span> <span class="va">..2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delta</span>, y <span class="op">=</span> <span class="va">rate_overlap_sig_uncond</span>,</span>
<span>                color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Sample size per group (n)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Standardized effect size (δ / σ)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"P(overlap &amp; sig)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"sample_effect.png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="b-unbalanced-and-heteroscesdastic-groups-geometry-parameter-r" class="level2"><h2 class="anchored" data-anchor-id="b-unbalanced-and-heteroscesdastic-groups-geometry-parameter-r"><strong>(b) Unbalanced and heteroscesdastic groups (geometry parameter r)</strong></h2>
<p>So far, we’ve assumed two groups of equal size and variance. But in real studies, sample sizes are often unbalanced and group variances may differ. Both of these design features affect the geometry parameter r and thus the width of the paradox window.</p>
<p>With equal variances</p>
<p><span class="math display">\[
SE_\Delta = \sigma \sqrt{\frac{1}{n_T} + \frac{1}{n_C}}, \space r = \frac{\sqrt{\frac{1}{n_T} + \frac{1}{n_C}}}{\frac{1}{\sqrt{n_T}} + \frac{1}{\sqrt{n_C}}}
\]</span></p>
<p>When <span class="math inline">\(n_T\)</span> = <span class="math inline">\(n_C\)</span>, the ratio r simplifies to <span class="math inline">\(1/\sqrt{2}\)</span>, giving the widest possible overlap window [1.96, 2.77].</p>
<p>As the groups become more unbalanced (say <span class="math inline">\(n_T\)</span> <span class="math inline">\(\ll\)</span> <span class="math inline">\(n_C\)</span>), the denominator of r grows faster than the numerator, pushing r closer to 1. That shrinks the window toward a single cutoff at 1.96, making “significant while overlapping” less likely.</p>
<p>If group variances differ, the same effect occurs. The group with larger variance dominates both numerator and denominator, again driving r closer to 1 and narrowing the window.</p>
<p>So in practice, imbalance and heteroscedasticity both work against the paradox, while balanced, equal-variance groups maximize the chance of seeing it.</p>
<p>In the simulation below, I varied both group sizes (balanced vs.&nbsp;unbalanced) and group variances (equal vs.&nbsp;unequal). The results show that the paradox “overlap while significant” arises when the test statistic <span class="math inline">\(\theta = \delta / SE_\Delta\)</span> lands in the window [1.96, 1.96/r]. Balanced, equal-variance designs maximize this window, making the paradox most visible; imbalance or heteroscedasticity sqeeze it.</p>
<p><img src="size_variance.png" class="img-fluid"></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_once_unbal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">delta</span>, <span class="va">sd_t</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd_c</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">yt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_t</span>, mean <span class="op">=</span> <span class="va">delta</span>, sd <span class="op">=</span> <span class="va">sd_t</span><span class="op">)</span></span>
<span>  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_c</span>, mean <span class="op">=</span> <span class="fl">0</span>,     sd <span class="op">=</span> <span class="va">sd_c</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mT</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yt</span><span class="op">)</span>;   <span class="va">mC</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yc</span><span class="op">)</span></span>
<span>  <span class="va">seT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">yt</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n_t</span><span class="op">)</span>; <span class="va">seC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">yc</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n_c</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">tcrit_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n_t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">tcrit_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n_c</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">ciT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mT</span> <span class="op">-</span> <span class="va">tcrit_t</span><span class="op">*</span><span class="va">seT</span>, <span class="va">mT</span> <span class="op">+</span> <span class="va">tcrit_t</span><span class="op">*</span><span class="va">seT</span><span class="op">)</span></span>
<span>  <span class="va">ciC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mC</span> <span class="op">-</span> <span class="va">tcrit_c</span><span class="op">*</span><span class="va">seC</span>, <span class="va">mC</span> <span class="op">+</span> <span class="va">tcrit_c</span><span class="op">*</span><span class="va">seC</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">overlap</span> <span class="op">&lt;-</span> <span class="fu">signed_norm_overlap</span><span class="op">(</span><span class="va">ciT</span>, <span class="va">ciC</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>  <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">yt</span>, <span class="va">yc</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>overlap <span class="op">=</span> <span class="va">overlap</span>, sig <span class="op">=</span> <span class="op">(</span><span class="va">pval</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">r_ratio</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd_c</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sd_t</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_t</span> <span class="op">+</span> <span class="va">sd_c</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_c</span><span class="op">)</span></span>
<span>  <span class="va">den</span> <span class="op">&lt;-</span> <span class="va">sd_t</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n_t</span><span class="op">)</span> <span class="op">+</span> <span class="va">sd_c</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n_c</span><span class="op">)</span></span>
<span>  <span class="va">num</span> <span class="op">/</span> <span class="va">den</span></span>
<span><span class="op">}</span></span>
<span><span class="va">theta_of</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span>, <span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd_c</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">se_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sd_t</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_t</span> <span class="op">+</span> <span class="va">sd_c</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_c</span><span class="op">)</span></span>
<span>  <span class="va">delta</span> <span class="op">/</span> <span class="va">se_delta</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">summarize_rates_unbal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">B</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">delta</span>, <span class="va">sd_t</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sd_c</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu">sim_once_unbal</span><span class="op">(</span><span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">delta</span>, <span class="va">sd_t</span>, <span class="va">sd_c</span>, <span class="va">alpha</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">overlap_flag</span> <span class="op">&lt;-</span> <span class="va">sims</span><span class="op">$</span><span class="va">overlap</span></span>
<span>  <span class="va">sig_flag</span>     <span class="op">&lt;-</span> <span class="va">sims</span><span class="op">$</span><span class="va">sig</span></span>
<span></span>
<span>  <span class="co"># 1) P(overlap &amp; sig)</span></span>
<span>  <span class="va">k1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">overlap_flag</span> <span class="op">&amp;</span> <span class="va">sig_flag</span><span class="op">)</span>; <span class="va">N1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span>  <span class="va">ci1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">N1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">)</span></span>
<span>  <span class="va">rate_uncond</span> <span class="op">&lt;-</span> <span class="va">k1</span> <span class="op">/</span> <span class="va">N1</span></span>
<span></span>
<span>  <span class="co"># 2) P(sig | overlap)</span></span>
<span>  <span class="va">N2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">overlap_flag</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">N2</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">k2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sig_flag</span><span class="op">[</span><span class="va">overlap_flag</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">rate_cond</span> <span class="op">&lt;-</span> <span class="va">k2</span> <span class="op">/</span> <span class="va">N2</span></span>
<span>    <span class="va">ci2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">k2</span>, <span class="va">N2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">rate_cond</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span>; <span class="va">ci2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">NA_real_</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    n_t <span class="op">=</span> <span class="va">n_t</span>, n_c <span class="op">=</span> <span class="va">n_c</span>, sd_t <span class="op">=</span> <span class="va">sd_t</span>, sd_c <span class="op">=</span> <span class="va">sd_c</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>    theta <span class="op">=</span> <span class="fu">theta_of</span><span class="op">(</span><span class="va">delta</span>, <span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span>, <span class="va">sd_c</span><span class="op">)</span>,</span>
<span>    r <span class="op">=</span> <span class="fu">r_ratio</span><span class="op">(</span><span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span>, <span class="va">sd_c</span><span class="op">)</span>,</span>
<span>    B <span class="op">=</span> <span class="va">B</span>,</span>
<span>    rate_overlap_sig_uncond <span class="op">=</span> <span class="va">rate_uncond</span>,</span>
<span>    ci_uncond_lo <span class="op">=</span> <span class="va">ci1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ci_uncond_hi <span class="op">=</span> <span class="va">ci1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    rate_sig_given_overlap  <span class="op">=</span> <span class="va">rate_cond</span>,</span>
<span>    ci_cond_lo <span class="op">=</span> <span class="va">ci2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ci_cond_hi <span class="op">=</span> <span class="va">ci2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    prop_overlap <span class="op">=</span> <span class="va">N2</span> <span class="op">/</span> <span class="va">N1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">theta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="va">scenarios</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>se_delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sd_t</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_t</span> <span class="op">+</span> <span class="va">sd_c</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_c</span><span class="op">)</span>,</span>
<span>         r       <span class="op">=</span> <span class="fu">r_ratio</span><span class="op">(</span><span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span>, <span class="va">sd_c</span><span class="op">)</span>,</span>
<span>         z_lo    <span class="op">=</span> <span class="fl">1.96</span>,</span>
<span>         z_hi    <span class="op">=</span> <span class="fl">1.96</span> <span class="op">/</span> <span class="va">r</span><span class="op">)</span></span>
<span></span>
<span><span class="va">param_grid</span> <span class="op">&lt;-</span> <span class="va">scen</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">pmap_dfr</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">param_grid</span><span class="op">$</span><span class="va">label</span>, <span class="va">param_grid</span><span class="op">$</span><span class="va">n_t</span>, <span class="va">param_grid</span><span class="op">$</span><span class="va">n_c</span>,</span>
<span>       <span class="va">param_grid</span><span class="op">$</span><span class="va">sd_t</span>,  <span class="va">param_grid</span><span class="op">$</span><span class="va">sd_c</span>, <span class="va">param_grid</span><span class="op">$</span><span class="va">theta</span>, <span class="va">param_grid</span><span class="op">$</span><span class="va">se_delta</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">label</span>, <span class="va">n_t</span>, <span class="va">n_c</span>, <span class="va">sd_t</span>, <span class="va">sd_c</span>, <span class="va">theta</span>, <span class="va">se_delta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">delta</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">*</span> <span class="va">se_delta</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">summarize_rates_unbal</span><span class="op">(</span>B <span class="op">=</span> <span class="va">B</span>, n_t <span class="op">=</span> <span class="va">n_t</span>, n_c <span class="op">=</span> <span class="va">n_c</span>,</span>
<span>                                 delta <span class="op">=</span> <span class="va">delta</span>, sd_t <span class="op">=</span> <span class="va">sd_t</span>, sd_c <span class="op">=</span> <span class="va">sd_c</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="va">label</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">z_lo</span>  <span class="op">&lt;-</span> <span class="fl">1.96</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">z_hi</span>  <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">/</span> <span class="va">out</span><span class="op">$</span><span class="va">r</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">res_theta</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">x_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">win</span><span class="op">$</span><span class="va">z_hi</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res_theta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">rate_overlap_sig_uncond</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">res_theta</span>, <span class="va">label</span>, <span class="va">z_lo</span>, <span class="va">z_hi</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">z_lo</span>, xmax <span class="op">=</span> <span class="va">z_hi</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>            inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    subtitle <span class="op">=</span> <span class="st">"Shaded band is the paradox window [1.96, 1.96/r] per scenario"</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span> <span class="op">==</span> <span class="va">delta</span> <span class="op">/</span> <span class="va">SE</span><span class="op">[</span><span class="va">Delta</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"P(overlap &amp; sig)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">label</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"size_variance.png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="best-practices-for-communication" class="level1"><h1>Best practices for communication</h1>
<p>The paradox of “overlap but significant” highlights why careful communication of treatment effects matters. Here are some practices I’ve found to help avoid this trap:</p>
<ul>
<li>
<p>Present a CI for the treatment effect, not just per-group means</p>
<p>The main inferential question is about the difference, not the groups in isolation. A CI around that difference makes the evidence explicit. If we also want to display group means with their own CIs, we need to be clear that inference is based on the difference CI. A good option is to overlay or annotate the effect estimate on the same figure, so readers can’t miss it.</p>
</li>
<li>
<p>Keep covariate adjustment consistent</p>
<p>Covariate adjustment (e.g.&nbsp;via regressions) reduces residual variance, often narrowing narrows the treatment effect’s CI. But inconsistency creates confusion: if we report raw, unadjusted group means alongside an adjusted treatment effect, the numbers won’t line up. The best practice is to present model-adjusted group means with their CIs and the adjusted treatment effect from the same model.</p>
</li>
<li>
<p>Use alternatives to group error bars when appropriate</p>
<p>Bar plots or mean plots with group error bars are familiar but can mislead, because audiences might put the focus on overlap instead of the treatment effect. For clearer communication, we can consider <strong>forest plots</strong>, where treatment effects are shown as dots with horizontal CIs against a zero line; <strong>difference plots</strong> in multi-arm studies, which place all contrasts relative to control; or <strong>side-by-side means with annotated differences</strong> if we want to preserve group context but highlight the comparison.</p>
</li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>