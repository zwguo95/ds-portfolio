---
title: "Visualize Percentages"
date: 04/18/2024
author:
  - name: Zhaowen Guo
    url: "https://www.linkedin.com/in/zhaowen-guo-20535312a/"
title-block-banner: true
format:
  html:
    theme: flatly
    code-fold: false
    code-tools: false
    toc: false
    number-sections: false
link-citations: true
categories: [code, visualization]
image: ".png"
---

```{r}
# Create a hypothetical dataset 
set.seed(123)
n <- 50
data <- data.frame(
  ID = 1:n,
  Attitude = sample(c("Support", "Oppose"), n, replace = TRUE),
  Gender = sample(c("Male", "Female"), n, replace = TRUE),
  Race = sample(c("Asian", "Black", "Hispanic", "White"), n, replace = TRUE)
)
```

```{r, message=FALSE}
# 
library(tidyverse)
library(waffle)
data %>%
  group_by(Attitude) %>%
  summarise(count = n()) %>%
  ggplot(aes(fill = Attitude, values = count)) +
  geom_waffle(
    n_rows = 10, 
    size = 0.5, 
    color = "white",
    flip = TRUE,
    make_proportional = TRUE,
    na.rm = TRUE
  ) + 
    scale_fill_manual(
    values = c("darkgoldenrod",
               "cornflowerblue"
               )
  ) +
  theme_void()
```

```{r, message=FALSE}
# setup fonts (otherwise, geom_pictorism will not be loaded)
library(extrafont)
extrafont::font_import(path="C:\\Users\\Administrator\\Downloads\\icons", pattern = "fa-", prompt =  FALSE)
loadfonts(device = "win")

# check installation of fonts
extrafont::fonttable() %>% 
  dplyr::as_tibble() %>% 
  dplyr::filter(grepl("Awesome", FamilyName)) %>% 
  select(FamilyName, FontName, fontfile)

# study fonts
library(showtext)
font_add(family = "FontAwesome5Free-Solid", regular = "C:\\Users\\Administrator\\Downloads\\icons\\fa-solid-900.ttf")
font_add(family = "FontAwesome5Free-Regular", regular = "C:\\Users\\Administrator\\Downloads\\icons\\fa-regular-400.ttf")
font_add(family = "FontAwesome5Brands-Regular", regular = "C:\\Users\\Administrator\\Downloads\\icons\\fa-brands-400.ttf")

showtext_auto()




data %>%
  group_by(Attitude) %>%
  summarise(count = n()) %>%
  ggplot(aes(label = Attitude, values = count, color = Attitude)) +
  geom_pictogram(n_rows = 10, 
                 flip = TRUE,
                 make_proportional = TRUE) +
  scale_color_manual(
    values = c("cornflowerblue",
               "darkgoldenrod")
  ) +
  scale_label_pictogram(
    name = NULL,
    values = c(
      Support = "thumbs-up", 
      Oppose = "thumbs-down"
    )
  ) +
  theme_void() + 
  theme(legend.position = "none")
```
```{r}
table(data$Gender)
data %>%
  group_by(Gender) %>%
  mutate(total = n()) %>%
  ungroup() %>%
  filter(Attitude == "Support") %>%
  group_by(Gender) %>%
  reframe(
    prop_support = round(n() / first(total),2) ,
    prop_nonsupport = 1 - prop_support
  ) %>%
  pivot_longer(2:3, names_to = "type", values_to = "percent") %>%
  ggplot(aes(values = percent, color = type, label = Gender)) +
  geom_pictogram(n_rows = 8, 
                 flip = TRUE,
                 make_proportional = TRUE) +
  scale_color_manual(
    values = c(prop_support = "cornflowerblue",
               prop_nonsupport = "grey80")
  ) +
  scale_label_pictogram(
    name = NULL,
    values = c(
      Male = "male",
      Female = "female"
    )
  ) +
    facet_wrap(~Gender) +
  theme_void()
```
```{r}
data %>%
  group_by(Gender, Attitude) %>%
  summarise(count = n()) %>%
  ggplot(aes(values = count, color = Attitude, label = Gender)) +
  geom_pictogram(n_rows = 10, 
                 flip = TRUE,
                 make_proportional = TRUE) +
  scale_color_manual(
    values = c(Support = "cornflowerblue",
               Oppose = "grey80")
  ) +
  scale_label_pictogram(
    name = NULL,
    values = c(
      Male = "male",
      Female = "female"
    )
  ) +
    facet_wrap(~Gender) +
  theme_void()  
```

